---
apiVersion: v1
kind: Secret
metadata:
  name: nginx-tls
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ3ekNDQXRlZ0F3SUJBZ0lVWXFDWjhieS9obzh1elRBYUF5am5oUnBxZVRBd0RRWUpLb1pJaHZjTkFRRUwKQlFBd2dZWXhDekFKQmdOVkJBWVRBbEpWTVJVd0V3WURWUVFJREF4VGRDNVFaWFJsY21KMWNtY3hEREFLQmdOVgpCQWNNQTFOd1lqRVVNQklHQTFVRUNnd0xSbTl2TFVSbGRtVnNiM0F4RERBS0JnTlZCQXNNQTBSbGRqRVRNQkVHCkExVUVBd3dLWm05dkxtSmhjaTV5ZFRFWk1CY0dDU3FHU0liM0RRRUpBUllLWm05dlFHSmhjaTV5ZFRBZUZ3MHkKTkRFd01ERXhNalUwTXpaYUZ3MHlOREV5TXpBeE1qVTBNelphTUlHR01Rc3dDUVlEVlFRR0V3SlNWVEVWTUJNRwpBMVVFQ0F3TVUzUXVVR1YwWlhKaWRYSm5NUXd3Q2dZRFZRUUhEQU5UY0dJeEZEQVNCZ05WQkFvTUMwWnZieTFFClpYWmxiRzl3TVF3d0NnWURWUVFMREFORVpYWXhFekFSQmdOVkJBTU1DbVp2Ynk1aVlYSXVjblV4R1RBWEJna3EKaGtpRzl3MEJDUUVXQ21admIwQmlZWEl1Y25Vd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFSwpBb0lCQVFEZk4yTmdTZVFMYU1nYW4xakkxSCsvZVlybG5TaXRONnVrQWpNQVNMenBrZ1FPZXhwbWZEeGZCQ3NxCkRhVUkyaEtwUjFjUWVTMXRXWFQ3OW8zRW9PYTFaTUVkTmM0U21RRWdMYUZvZ2t4aFhHNXVmL3hmV3VqM3JOUUEKRGxUNlVSU29QUzhtbVdIVzZrb1lKYzZBVmkvVFByMDRPNTVRM0ZTWEExaWdUNVY1eWppYWdjeXhhTU5xc1V3RgpwcmxtNGo2S0ZMMG1wSHFqMHpmN3hxd09mUlFQanQwNFhjVElRMFNlcW1QSUNteGtlcFJrNThUT3lNYTRJay9oCmRMQm5LR0NoblpkT1NFTXNFS29haGRmTlVSKzVwdU1IZEo5cUE5REgvY2VlTklLTWdYUnllU1J3K2FVVzVEYnEKY01rTzVvRW5pM1dONGh4NjQ3VG15UlZ5dGVPMUFnTUJBQUdqVXpCUk1CMEdBMVVkRGdRV0JCUmxiZUhwY2czZwpQQzJpV05EL0l1eE5GbjFxS0RBZkJnTlZIU01FR0RBV2dCUmxiZUhwY2czZ1BDMmlXTkQvSXV4TkZuMXFLREFQCkJnTlZIUk1CQWY4RUJUQURBUUgvTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFBZ3llcWg1S2k5bEVYN2JMS08KSUprTDI1aktpaHNwWiswdVY5cDA5cXUwT1A3K0xyQTlxREFoL3JwbWFMQk53UE1CWVB3TFVTUnhjZzFOYmhtaQowQmRJcTN6SmNQOXVwU2VvWmtyOG9sbXBEaVU2aEVtN1k5dzhMTmhOSytQd0hGUlRuODNLdkRwYTEremlyM2hFCm91U3NTMDYxS2xLNGx5anBqRURjTWZhYVlLQVZBd216dHMxNU9UbUFGeXhKekt3Ni9kTGJ1VHIzVVoza3FWTkcKYmxOTXowZGlncjN5T2xXQXZyT3FrUU50UWRUS3Q1STFIYlhvb01sOXdsV0tSWVZmVnNjamVwYnF4UXlUN0dOcApadEZKeXkxb0pkWXY1SUlnbExDamlrRHRzNzcxM3JLeDhqeWhEU24raThIYm9FUkdEVWI5U2ZoWXNBbkhVdVVyCmpxSmwKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRRGZOMk5nU2VRTGFNZ2EKbjFqSTFIKy9lWXJsblNpdE42dWtBak1BU0x6cGtnUU9leHBtZkR4ZkJDc3FEYVVJMmhLcFIxY1FlUzF0V1hUNwo5bzNFb09hMVpNRWROYzRTbVFFZ0xhRm9na3hoWEc1dWYveGZXdWozck5RQURsVDZVUlNvUFM4bW1XSFc2a29ZCkpjNkFWaS9UUHIwNE81NVEzRlNYQTFpZ1Q1VjV5amlhZ2N5eGFNTnFzVXdGcHJsbTRqNktGTDBtcEhxajB6ZjcKeHF3T2ZSUVBqdDA0WGNUSVEwU2VxbVBJQ214a2VwUms1OFRPeU1hNElrL2hkTEJuS0dDaG5aZE9TRU1zRUtvYQpoZGZOVVIrNXB1TUhkSjlxQTlESC9jZWVOSUtNZ1hSeWVTUncrYVVXNURicWNNa081b0VuaTNXTjRoeDY0N1RtCnlSVnl0ZU8xQWdNQkFBRUNnZ0VCQUpicFI1S040bE9rWDhVLy9qS3BHRVZIMHhReUVKSXJsU3VwSVBvTU0weG0Kbjc5Nmt2cSsrOEh4ZTQxTzlFanJ4cm9UdFZVNTEvQ2FEbkZhMjdZWVltSTQ0Q2J6ZllNdFZvbCswQ1ZzRWwrdwpzaWlhOXZFdzhWaWh6Q0xOamI0K213eXpjUEZUdWNZbldEakROcjJsaDJmMmZzOUozMXNqMnp6TjBsbHY5TXNGCkhYWTVsVk1MNHRPQ0FGOTA3SGsxcjRIZHZBd0QxS0cySkNYY3UrUG9lY0VyNzlUN2JIQXZIRVFjbTg2cmsrUTgKODZEQjhXaHNCSHZTdkJWajhFL2s4UWVsNVEvR25saEpxSUpoYXUzUWUwZXFyck1DWmh6cEV1SUtjcWRFOEI1ZApscWphVzEweHRWRlhXT1hjdDVwWFdwU0drSXJRMmNYZGNkOUVKVkpvRi9FQ2dZRUErakZVaUVqbXRLNmxlTUtsCmlpNHlmdnQ3YWl0TE5SWnBYM1BLbnZmNVFMVmxhZ29JenZRd0dhLzRwb2p2dnE4VnE3eWlIMzB0KzlhbU13UFIKNlVhK0Z4RjVLRWJRUldQQkl3b3FpWGloRUw2SFUydlpWdlBiRW1JdytkdkprZ0hSM1JQSHA0ZHJnL2IzUmRWcwp5SEcxcTFodVQ4OGFKdkJzQWpSOHBUSkt1Z01DZ1lFQTVHWEREVWowWUdtREgrbU95U0RHL21YMmMwSDUrMFBQCjZvamJrZkwzMnlkNFJveGwwck80M3VEMkdoWmMrQlNuRTRTc0Q1MlA1dXBSVmIyNE1SMUp0L3ZZZHNMK0tVaVoKZW1BeG9SNWhZZXpnSjJuMU9YR0V2K2V0QmEyUzhyM0dPKzNLV3FReGFyY281dFpDbEJFOG83cHlNSWV6SEJNQwo5MVQzQkZyZldlY0NnWUFLaTAydXVMUFFaWlBmdFFSWkFIMXNVSmp3N29ZcTVKam9SdThCS0I0L0ZlWUNSQTMrCit0ZVVIWkJ6SkU1R1VRYXV5REprOVZlY3gzMFZwVkdSYlVQUm9SRGtHNmZuWkw3ZEJTNnB3SVc1T081bkc2SjcKUWFlMzdKOTN5RVdFZThNbWVCRHdCSXNKY3IwVkdsdU5UdzJDL1NVWkEvZHNNTEc4bmcycXdLWFpsUUtCZ0Jadgp3TGQvWVRKUGF5Z3BZM055bXRuRzNtejRJRHlFcnRvVlU2eUV0OEI1b2lFY0RheWpKeGdOOVY4ZXIwZFhrQW9rCjBGcEFXakNPK0NwNkZxd01lbjl1YUJkU2xIRXR4cFgwK1NzZ3R1Uk54cjlZYzFTUFNFRXAyeDlocTd2WTFLNXkKYjV4ejRMN2crMDJoNHF4MC9RWUFmTk16b1c2eWwyb0FtTHQreWM0bEFvR0FaSUtHVDN4TTRhb09OaUJlQ3IzbQpIQ3AzMG9UcXcrbFVGT2x6dEV0SVQyT1A0cGRYbWl2NUNFM0Yxb1R6TVhmeFlETEVLQjhhNzg4VG03ZU5pRWZGCnhqN252ZHdZamJzYnZxYjA5SW1NbHNzbWorZTVEUlRxMkRVWXliMHlzOFJaOUE3TStXTWRTbHJ2Nmd3ajc3WG8KWkNFakJvSDArUS8zTGpsRG5DMFVTcGs9Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
type: kubernetes.io/tls
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx
  labels:
    env: test
    app: main
    tiers: frontend
    owner: VStupa
spec:
  selector:
    matchLabels:
      app: frontend
  replicas: 1 # tells deployment to run 2 pods matching the template
  template:
    metadata:
      labels:
        app: frontend # Service(Proxy) will look for those Pods labels
    spec:
      containers:
        - name: nginx
          image: nginx:latest
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 80
              name: nginx-port
          volumeMounts:
            - name: workdir
              mountPath: /usr/share/nginx/html
      volumes:
        - name: workdir
          configMap:
            name: html-conf
---
# This action to replace a default index.html of nginx web server.
apiVersion: v1
kind: ConfigMap
metadata:
  name: html-conf
data:
  index.html: |
    <html>
    <body>
      <h1>Hello from NGINX by K8S</h1>
    </body>
    </html>
---
apiVersion: v1
kind: Service
metadata:
  name: myapp-nginx
spec:
  selector:
    app: frontend # Select pods with those labels
  ports:
    - name: nginx-http
      protocol: TCP
      port: 80 # Port on proxy
      targetPort: nginx-port # Port on pods
  #type: NodePort
  #type: ClusterIP
  #type: LoadBalancer
